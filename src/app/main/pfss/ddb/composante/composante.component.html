<div class="page-layout simple fullwidth" fxLayout="column">
    <div class="header primary p-4 h-24" fxLayout="row" fxLayoutAlign="start center">
        <div fxLayout="column" fxLayoutAlign="center start">
            <div fxLayout="row" fxLayoutAlign="start center"
                style="margin-top: 0px !important; padding-top: 0px !important;">
                <mat-icon class="s-18 coleur_vert">home</mat-icon>
                <mat-icon class="s-18 coleur_vert">chevron_right</mat-icon>
                <span class="coleur_vert">Données de base</span>
                <mat-icon class="s-18 coleur_vert">chevron_right</mat-icon>
                <span class="coleur_vert">Composante</span>
            </div>
        </div>
    </div>
    <div class="content">
        <div class="tab-content p-2">
            <div class="mat-card mat-elevation-z4  m-4">
                <div class="package-type h-44 primary-50 header primary" fxLayout="row"
                    fxLayoutAlign="space-between center">
                    <div class="p-12">
                        <span class="border-right mr-2 coleur_vert">Actions </span>

                        <button mat-button mat-icon-button color="fuse-navy" aria-label="Ajouter" (click)="ajouter()"
                            matTooltip="Ajouter" *ngIf="!this.new_item && !this.editing[this.index_selected]">
                            <mat-icon class="coleur_vert">add_circle_outline</mat-icon>
                        </button>
                        <button mat-button mat-icon-button color="fuse-navy" aria-label="Modifier_client"
                            (click)="modifier()" *ngIf="item_selected.length > 0 && !this.editing[this.index_selected]"
                            matTooltip="Modifier">
                            <mat-icon class="coleur_vert">edit</mat-icon>
                        </button>
                        <button mat-button mat-icon-button color="fuse-navy" aria-label="Supprimer"
                            *ngIf="item_selected.length > 0 && !this.editing[this.index_selected]" (click)="supprimer()"
                            matTooltip="Supprimer">
                            <mat-icon class="coleur_vert">delete</mat-icon>
                        </button>
                        <button mat-button mat-icon-button color="fuse-navy" aria-label="Supprimer"
                            *ngIf="this.editing[this.index_selected]" (click)="save_in_base(0)">
                            <mat-icon class="coleur_vert">save</mat-icon>
                        </button>
                        <button mat-button mat-icon-button color="fuse-navy" aria-label="Annuler" (click)="annuler()"
                            *ngIf="item_selected.length > 0 && this.editing[this.index_selected]">
                            <mat-icon class="coleur_vert">cancel</mat-icon>
                        </button>
                        <button mat-stroked-button style="color: #0eaf3b;" (click)="export_excel()">
                            <mat-icon>get_app</mat-icon>
                            EXPORTER EN EXCEL
                        </button>

                    </div>
                    <div class="border-right mr-2 coleur_vert title">COMPOSANTE </div>
                    <div class="p-12">
                        <input type="text"
                            style="padding:8px;margin:15px auto;width:100%;color:#353A48; border: 1px solid #babdc5;"
                            placeholder="Rechercher..." [(ngModel)]="search" />
                    </div>
                </div>
                <div>
                    <ngx-datatable class="material" [rows]="rows_composante | filter: search"
                        [loadingIndicator]="loadingIndicator" [columnMode]="'force'" [headerHeight]="48"
                        [footerHeight]="56" [rowHeight]="'auto'" [scrollbarH]="true" [reorderable]=""
                        [selectionType]="'checkbox'" [limit]="10" [selected]="item_selected" [selectionType]="'single'"
                        (select)="onSelectComposante($event)">
                        <ngx-datatable-column name="Code" prop="code">
                            <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                let-row="row">
                                <span *ngIf="!editing[rowIndex]">{{ value }}</span>
                                <input *ngIf="editing[rowIndex]" type="text"
                                    (change)="updateValue($event, 'code', rowIndex)" [value]="value" />
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Libellé" prop="libelle">
                            <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                let-row="row">
                                <span *ngIf="!editing[rowIndex]">{{ value }}</span>
                                <input *ngIf="editing[rowIndex]" type="text"
                                    (change)="updateValue($event, 'libelle', rowIndex)" [value]="value" />
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Montant prevu" prop="montant_prevu">
                            <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                let-row="row">
                                <span *ngIf="!editing[rowIndex]">{{ value }}</span>
                                <input *ngIf="editing[rowIndex]" type="text"
                                    (change)="updateValue($event, 'montant_prevu', rowIndex)" [value]="value" />
                            </ng-template>
                        </ngx-datatable-column>
                    </ngx-datatable>
                </div>
            </div>
        </div>
    </div>
    <ng-template #suppressionDialog>
        <h2 matDialogTitle>Etes-vous sûr de supprimer cet enregistrement ?</h2>
        <mat-dialog-content>

        </mat-dialog-content>
        <mat-dialog-actions align="end">
            <button mat-button matDialogClose style="color: red;" (click)="suppressionConfirmer()">OUI</button>
            <button mat-button matDialogClose (click)="suppressionAnnuler()" color="primary">NON</button>
        </mat-dialog-actions>
    </ng-template>

</div>