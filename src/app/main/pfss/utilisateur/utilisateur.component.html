<div class="page-layout simple fullwidth" fxLayout="column">
    <div class="header primary p-4 h-24" fxLayout="row" fxLayoutAlign="start center">
        <div fxLayout="column" fxLayoutAlign="center start">
            <div fxLayout="row" fxLayoutAlign="start center"
                style="margin-top: 0px !important; padding-top: 0px !important;">
                <mat-icon class="s-18 coleur_vert">home</mat-icon>
                <mat-icon class="s-18 coleur_vert">chevron_right</mat-icon>
                <span class="coleur_vert">Administration</span>
                <mat-icon class="s-18 coleur_vert">chevron_right</mat-icon>
                <span class="coleur_vert">utilisateurs</span>
                <mat-icon class="s-18 coleur_vert">chevron_right</mat-icon>
                <span class="coleur_vert">Gestion utilisateurs</span>
            </div>
        </div>
    </div>
    <div class="content">
        <div class="tab-content p-2">
            <div class="mat-card mat-elevation-z4  m-4">
                <div class="package-type h-44 primary-50 header primary" fxLayout="row"
                    fxLayoutAlign="space-between center">
                    <div class="p-12">
                        <span class="border-right mr-2 coleur_vert">Actions </span>
                        <button mat-stroked-button style="color: #0eaf3b;">
                            <mat-icon>get_app</mat-icon>
                            EXPORTER EN EXCEL
                        </button>
                        <button mat-button mat-icon-button color="fuse-navy" aria-label="Modifier" matTooltip="Modifier"
                            *ngIf="afficherBouttonModifier" (click)="ModifierUtilisateur()">
                            <mat-icon class="coleur_vert">edit</mat-icon>
                        </button>
                    </div>
                    <div class="border-right mr-2 coleur_vert title">LISTE DES UTILISATEURS </div>
                    <div class="p-12">
                        <input type="text"
                            style="padding:8px;margin:15px auto;width:100%;color:#353A48; border: 1px solid #babdc5;"
                            placeholder="Rechercher..." [(ngModel)]="rechercher_user" />
                    </div>
                </div>
                <mat-tab-group *ngIf="afficherUserFormModification">
                    <mat-tab label="Modification utilisateur">
                        <div class="divform">
                            <form name="userFormModification" [formGroup]="userFormModification" novalidate
                                fxLayout="column" fxLayoutAlign="center center" fxLayout.xs="row">
                                <div class="centerinput">

                                    <input type="hidden" formControlName="id" [(ngModel)]="utilisateur.id">

                                    <mat-form-field fxFlex="100" class="pl-4" appearance="outline">
                                        <mat-label>Nom</mat-label>
                                        <input matInput formControlName="nom" [(ngModel)]="utilisateur.nom">
                                        <mat-icon matSuffix class="secondary-text">
                                            account_circle
                                        </mat-icon>
                                        <mat-error>
                                            Nom obligatoire
                                        </mat-error>
                                    </mat-form-field>

                                    <mat-form-field fxFlex="100" class="pl-4" appearance="outline">
                                        <mat-label>Prenom</mat-label>
                                        <input matInput formControlName="prenom" [(ngModel)]="utilisateur.prenom">
                                        <mat-icon matSuffix class="secondary-text">
                                            account_circle
                                        </mat-icon>
                                        <mat-error>
                                            Prenom obligatoire
                                        </mat-error>
                                    </mat-form-field>
                                    <mat-form-field fxFlex="100" class="pl-4" appearance="outline">
                                        <mat-label>Email</mat-label>
                                        <input matInput formControlName="email" [(ngModel)]="utilisateur.email">
                                        <mat-icon matSuffix class="secondary-text">
                                            account_circle
                                        </mat-icon>
                                        <mat-error>
                                            Email obligatoire
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="centerinput">
                                    <mat-form-field fxFlex="30" class="pl-4" appearance="outline" fxFlex
                                        style="width:80px;">
                                        <mat-label>Etat</mat-label>
                                        <!--input matInput formControlName="sigle" [(ngModel)]="utilisateur.sigle"-->
                                        <select matNativeControl formControlName="enabled" [(ngModel)]="utilisateur.enabled">
                                            <option [value]="0">Inactif</option>
                                            <option [value]="1">Actif</option>
                                        </select>
                                    </mat-form-field>
                                </div>
                                <div>&nbsp;</div>
                                <section class="example-section">
                                    <h4>Privilèges:</h4>
                                    <p>
                                        <mat-checkbox MatNativeControl formControlName="user" [disabled]="true">Utilisateur</mat-checkbox>
                                    </p>
                                    <p>
                                        <mat-checkbox MatNativeControl formControlName="ddb">Données de base</mat-checkbox>
                                    </p>
                                    <p>
                                        <mat-checkbox MatNativeControl formControlName="admin">Administrateur</mat-checkbox>
                                    </p>
                                </section>
                                <div fxLayout="row" fxLayoutAlign="start start">
                                    <button (click)="ajoutUser(utilisateur,0)" mat-raised-button color="accent"
                                        class="submit-button ml-4" aria-label="CREATE AN FORM"
                                        [disabled]="userFormModification.invalid">
                                        Enregistrer
                                    </button>
                                    <button (click)="fermerFormModificationUser()" mat-raised-button color="accent"
                                        aria-label="ANNULER AN FORM" class="ml-4">
                                        ANNULER
                                    </button><br><br>
                                </div>
                            </form>
                        </div>
                    </mat-tab>
                </mat-tab-group>
                <div>
                    <ngx-datatable class=" material" [loadingIndicator]="loadingIndicator" [columnMode]="'force'"
                        [headerHeight]="48" [footerHeight]="56" [rowHeight]="'auto'" [scrollbarH]="true"
                        [rows]="rows_users  | filter: rechercher_user" [selected]="selected_user"
                        (select)='onSelectUtilisateur($event)' [reorderable]="reorderable" [selectionType]="'single'"
                        [limit]="10">

                        <ngx-datatable-column name="Nom">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                {{row.nom}}
                            </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Prenom">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                {{row.prenom}}
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Email">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                {{row.email}}
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Etat">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                {{affichage_etat(row.enabled)}}
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="Privilège">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                {{row.roles}}
                            </ng-template>
                        </ngx-datatable-column>
                        <!-- <ngx-datatable-column name="Nom du Personnel" prop="personnel.nom">
                            <ng-template let-row="row" ngx-datatable-cell-template let-value="value">
                                {{value}}
                            </ng-template>
                        </ngx-datatable-column> -->


                    </ngx-datatable>
                </div>
            </div>
        </div>
    </div>
</div>